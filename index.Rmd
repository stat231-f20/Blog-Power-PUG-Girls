---
title: "A Statistical Analysis of Beyoncé and Jay-Z"
author: "PowerPug Girls: Alex, Grace, & Jamie"
output:
  tufte::tufte_html:
    thumbnails: false
    highlight: NULL
---

<body style="background-color:#f6c9a0;">

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.align="center")
library(tidyverse)
library(tidytext)
library(rvest)
library(robotstxt)
library(stringr)
library(dplyr)
library(genius)

library(ggplot2)
library(data.table)
library(forcats)
library(extrafont)

library(ggrepel)
library(ggimage)
library(knitr)
```

# Soundfile

Adding example audio using html code.  You can see further explanation, including what internet browsers support what types of audio files [here](https://www.w3schools.com/html/html5_audio.asp).

<audio controls>
  <source src="audio/Freedom.mp3" type="audio/mpeg">
Your browser does not support the audio element.
</audio>

## Header 2

### Header 3

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For example, you can include **Bold** and _Italic_ and `Code` text.  For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

You should test out updating your GitHub Pages website:

- clone your group's blog project repo in RStudio
- update "Your Project Title Here" to a new title in the YAML header
- knit `index.Rmd` 
- commit and push BOTH the `index.Rmd` and the `index.html` files
- go to https://stat231-f20.github.io/Blog-Power-PUG-Girls/ to see the published test document (this is publicly available!)

## Including code and plots

You can embed code as normal, for example:

```{r cars, echo=FALSE}
mosaic::favstats(~speed, data = cars)
```

Let's clean up the format of that output:

```{r pretty, echo=FALSE, warning=FALSE, message=FALSE}
library(kableExtra)
summary(cars) %>%
  kable(col.names = c("Speed", "Distance")
        , row.names = F) %>%
  kable_styling(bootstrap_options = "striped"
                , full_width = F) %>%
  row_spec(0, bold = T, underline = T) %>%
  column_spec(1:2, width = "1.5in") 
```

In a study from the 1920s, fifty cars were used to see how the speed of the car and the distance taken to stop were related.  Speeds ranged between `r min(cars$speed)` and `r max(cars$speed)` mph.  Distances taken to stop ranged between `r min(cars$dist)` and `r max(cars$dist)` feet, with the middle 50% falling between `r as.numeric(quantile(cars$dist)[2])` and `r as.numeric(quantile(cars$dist)[4])` feet.  

You can also embed plots as normal, for example:

```{r figure1, echo=FALSE}
ggplot(data = cars, aes(x = speed, y = dist)) + 
  geom_point() + 
  labs(x = "Speed of car (mph)"
       , y = "Distance taken to stop (ft)"
       , title = "cars data (1920s)")
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


## Including links and images

You can include [Links](https://www.datadreaming.org/post/r-markdown-theme-gallery/) and images ![team logo](https://raw.githubusercontent.com/stat231-f20/Blog-Power-PUG-Girls/main/images/powerPUGgirls.png)


# You can even create tabs if you want! {.tabset .tabset-fade .tabset-pills}

## Bulleted list

You can make a bulleted list like this:

- item 1
- item 2
- item 3


## Numbered list

You can make a numbered list like this

1. First thing I want to say
2. Second thing I want to say
3. Third thing I want to say






# Introduction











# Data

Here are the various sources of our data:

- Lyrics from the `genius` package









# Lyric Analysis

```{r, include=FALSE}
in_path <- "C:/Users/abran/OneDrive/Documents/STAT 231 - Data Science/git/Blog-Power-PUG-Girls"

beyonce_lyrics <- read.csv(paste0(in_path,"/beyonce_lyrics.csv")) %>% 
  mutate(lyric = as.character(lyric)) %>% 
  rename(album = title) 
jayZ_lyrics <- read.csv(paste0(in_path,"/jayZ_lyrics.csv")) %>% 
  mutate(lyric = as.character(lyric)) %>% 
  rename(album = title)

data(stop_words)
```

```{r, include=FALSE} 
# Extract Unigrams from all songs, and from Lemonade / 4:44

beyonce_ngrams <- beyonce_lyrics %>% 
  unnest_tokens(output = unigram, input = lyric) %>% 
  anti_join(stop_words, by = c("unigram" = "word")) %>% 
  na.omit()

jayZ_ngrams <- jayZ_lyrics %>% 
  unnest_tokens(output = unigram, input = lyric) %>% 
  anti_join(stop_words, by = c("unigram" = "word")) %>% 
  na.omit()

beyonce_ngrams_lemonade <- beyonce_ngrams %>% 
  filter(album == "Lemonade")

jayZ_ngrams_444 <- jayZ_ngrams %>% 
  filter(album == "4:44")

# "Run the World (Girls)" for example in paragraph
beyonce_rtw <- beyonce_ngrams %>% 
  filter(track_title == "Run the World (Girls)")%>% 
  count(unigram, sort = TRUE) 

# "Freedom" for example in paragraph
beyonce_freedom <- beyonce_ngrams_lemonade %>% 
  filter(track_n == 10) %>% 
  count(unigram, sort = TRUE) 

# "Legacy" for example in paragraph
jayZ_legacy <- jayZ_ngrams_444 %>% 
  filter(track_title == "Legacy") %>% 
  count(unigram, sort = TRUE) 
```

```{r, include=FALSE}
# Frequencies

beyonce_ngrams_f <- beyonce_ngrams %>% 
  count(unigram, sort = TRUE) 

jayZ_ngrams_f <- jayZ_ngrams %>% 
  count(unigram, sort = TRUE) 

beyonce_ngrams_lemonade_f <- beyonce_ngrams_lemonade %>% 
  count(unigram, sort = TRUE) 

jayZ_ngrams_444_f <- jayZ_ngrams_444 %>% 
  count(unigram, sort = TRUE) 

```

```{r, include=FALSE}
# Remove n-word from visualisations

# I did this right before visualisation
#   as to perserve the original data 
#   and to avoid potential errors with "*" characters. 

jayZ_ngrams_f2 <- jayZ_ngrams_f %>% 
  mutate(unigram = case_when(unigram == "nigga" ~ "n***a",
                             unigram == "niggas" ~ "n***as",
                             T ~ unigram))


jayZ_ngrams_444_f2 <- jayZ_ngrams_444_f %>% 
  mutate(unigram = case_when(unigram == "nigga" ~ "n***a",
                             unigram == "niggas" ~ "n***as",
                             T ~ unigram))
```

For the text analysis of the lyrics, our key questions of interest were: How do the lyrics of Beyoncé songs differ from "Lemonade"? How do the lyrics of Jay-Z songs differ from "4:44"? But, progressing into our analysis, we quickly realised that text analysis is not entirely appropriate to songs, nor is particualrly insightful for either of these artists. So, the analysis took on a different purpose: what information can be gleaned, at all, from a text analysis of Beyoncé and Jay-Z songs, and "Lemonade" and "4:44"? And what information is lost in a text analysis?

## Beyoncé

Beyoncé is up first. The two visualisations below show the 20 most frequent words across Beyoncé's discography and in "Lemonade" specifically. 

```{r, echo=FALSE}
# Beyonce Visualisations

beyonce_ngrams_f %>% 
  slice(1:20) %>% 
  ggplot(aes(
    x = reorder(unigram, n), 
    y = n, 
    color = unigram, 
    fill = unigram)) +
  geom_col() +
  xlab(NULL) +
  coord_flip() +
  labs(
    y = "Number of instances", 
    title = "Most frequent words in all Beyoncé songs"
    ) +
  guides(color = "none", fill = "none") +
  theme(plot.background = element_rect(fill = "#f6c9a0", color = "#f6c9a0"), 
        panel.background = element_rect(fill = "#f6c9a0", color = "#f6c9a0"),
        panel.grid.major = element_line(color = "black"),
        panel.grid.minor = element_line(color = "black"),
        text = element_text(family = "serif"))

beyonce_ngrams_lemonade_f %>% 
  slice(1:20) %>% 
  ggplot(aes(
    x = reorder(unigram, n), 
    y = n, 
    color = unigram, 
    fill = unigram)) +
  geom_col() +
  xlab(NULL) +
  coord_flip() +
  labs(
    y = "Number of instances", 
    title = "Most frequent words in \"Lemonade\""
    ) +
  guides(color = "none", fill = "none") +
  theme(plot.background = element_rect(fill = "#f6c9a0", color = "#f6c9a0"), 
        panel.background = element_rect(fill = "#f6c9a0", color = "#f6c9a0"),
        panel.grid.major = element_line(color = "black"),
        panel.grid.minor = element_line(color = "black"),
        text = element_text(family = "serif"))
```

There are not any significant differences between "Lemonade" and her complete discography. Moreover, the nature of Beyoncé's musicality is a counfounding variable which informs which words are most frequent, more than "theme" does. Most of her songs repeats a central word or phrases. The song "Run the World (Girls)" is a prime example. The song repeats the title phrase 32 times; the words "run", "world" and "girls" are all in the top 10 words of Beyoncé's discography. 

The same is true for "Lemonade". While freedom is a central theme of the album, it is high on the frequency list largely in part due to the song "Freedom (ft. Kendrick Lamar)", which contains the word "freedom" 21 times. Largely, this counfounding issue exposes a fundamental issue with using text analysis on songs: the meaning of a song is not necesarily in the lyrics, but in the music.

However, beyond the fundamental restrictions of using text analysis of music, it is clear that "love" is a central theme of Beyoncé's music. It is the most frequent word across Beyoncé's discography and in "Lemonade" specifically. Of course, the word suffers from the same issue as in "Run the World (Girls)" and "Freedom (ft. Kendrick Lamar)". "Love" is in the central pattern of a number of her songs, including "Love on Top", "Crazy in Love (feat. Jay-Z)" -- two of her most well known songs -- and in "Love Drought" in "Lemonade.

In this case, we are less concerned with the confounding impact of the song pattern, because the word "love" appears in the central pattern of multiple songs, as well as smaller instances in other songs. Female enpowerment is another theme visible in the word frequency visualisations. 

There are many themes central to Beyoncé's discography and to "Lemonade" that do not appear in the word frequency visualisations. Most notably, her focus on pride and reclaimation of her Black heritage is not visible. This theme can be readily intepreted from the music and visual accompaniments of "Lemonade". Text analysis does not offer us the full picture, in this instance.

## Jay-Z

Next up is Jay-Z. The two visualisations below show the 20 most frequent words across Jay-Z's discography and in "4:44" specifically. 

```{r, echo=FALSE}
# Jay-Z Visualisations

jayZ_ngrams_f2 %>% 
  slice(1:20) %>% 
  ggplot(aes(
    x = reorder(unigram, n), 
    y = n, 
    color = unigram, 
    fill = unigram)) +
  geom_col() +
  xlab(NULL) +
  coord_flip() +
  labs(
    y = "Number of instances", 
    title = "Most frequent words in all Jay-Z songs"
    ) +
  guides(color = "none", fill = "none") +
  theme(plot.background = element_rect(fill = "#f6c9a0", color = "#f6c9a0"), 
        panel.background = element_rect(fill = "#f6c9a0", color = "#f6c9a0"),
        panel.grid.major = element_line(color = "black"),
        panel.grid.minor = element_line(color = "black"),
        text = element_text(family = "serif"))

jayZ_ngrams_444_f2 %>% 
  slice(1:20) %>% 
  ggplot(aes(
    x = reorder(unigram, n), 
    y = n, 
    color = unigram, 
    fill = unigram)) +
  geom_col() +
  xlab(NULL) +
  coord_flip() +
  labs(
    y = "Number of instances", 
    title = "Most frequent words in \"4:44\""
    ) +
  guides(color = "none", fill = "none") +
  theme(plot.background = element_rect(fill = "#f6c9a0", color = "#f6c9a0"), 
        panel.background = element_rect(fill = "#f6c9a0", color = "#f6c9a0"),
        panel.grid.major = element_line(color = "black"),
        panel.grid.minor = element_line(color = "black"),
        text = element_text(family = "serif"))
```

Before addressing the differences between the two, it is important to acknowledge the presence of stop words in the visualisations. Early in the wrangling process, we removed stop words using the `stop_words` dataset built into R. And yet, 8 of the 20 most frequent words in Jay-Z songs are stop words, vocalisations like "uh" and exclamations like "yeah". The default stop words package seems to have an inflexible range. Maybe, words like "y'all" provide a cultural context, so are not removed. More likely, the stop word dataset is intended for literaturem not music. Still, the implications of such a specification makes the cultural center of their text analysis eurocentric. 

Both summaries of Jay-Z songs also show that his songs contain many explatives. This is noteworthy compared to Beyoncé, who does not often use curse words. But, we cannot necessarily prescribe a difference in theme or meaning from this text analysis. Instead, the confounding variable is that their music belong to different genres. Beyoncé is not a rap artist; Jay-Z is. 
Within the framework of rap, a field of literature with a developing body of work, I question whether these explatives are stop words or not. Certainly, in comparison with other genres of music, they are exceptional. But, in comparison with other rap music, this is not particularly noteworthy. The n-word also has a unique cultural role in rap music that the visualisation reflects. The n-word and the plural are the two most frequent words in Jay-Z's music. Again, I do not attribute this to Jay-Z in particular, but to the genre of rap. 

And, just like with Beyoncé's songs, text analysis is uniquely inadequete for rap music. The meaning, style and emotion conveyed lie in the sound. 

Regardless of these restrictions, looking past the stop words in the reference of rap music, differences between the set and subset of Jay-Z's music appear. "4:44", compared to all Jay-Z songs, touches on themes related to Jay-Z's infamous infidelity: "family" and "legacy". Just like with Beyoncé's music, however, such an ascription is faulty; the song "Legacy" in "4:44" contains "legacy" 16 times. 

And, similarly to Beyoncé, Jay-Z's most frequent word of meaning is "love". These two artists, despite having vastly different styles and belonging to different genres of music, still base their music on the same central theme. And, despite the narrative of struggling with infidelity that both "Lemonade" and "4:44" grapple with, they are both still about love.  








# Chart Analysis

```{r, echo=FALSE}
path_in <- "C:/Users/abran/OneDrive/Documents/STAT 231 - Data Science/git/Blog-Power-PUG-Girls"

Beyonce <- read_csv(paste0(path_in,"/Beyonce_Chart.csv")) %>%
  mutate(peak_position = as.numeric(peak_position))
JayZ <- read_csv(paste0(path_in,"/JayZ_Chart.csv")) %>%
  mutate(peak_position = as.numeric(peak_position))

Beyonce$artist <- c('Beyonce')
JayZ$artist <- c('Jay Z')

Beyonce$year <- c(2003, 2006, 2007, 2008, 2011, 2013, 2014, 2016, 2019)

JayZ$year <-c(1997, 2000, 2001, 2002, 2002, 2002, 2003, 2004, 2004, 2006, 2007, 2009, 2010, 2011, 2013, 2017)

vec_b <- c(70, 26, 22, 129, 63, 61, 2, 44, 5)
vec1 <- c(5, 0, 0, 0, 2, 0, 0, 1, 0)


vec_j <- c(1, 2, 10, 3, 1, 16, 24, 2, 17, 5, 5, 38, 9, 63, 15, 9)
vec_2 <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0)

Beyonce$weeks_on_chart <-vec_b
Beyonce$weeks_number_one <- vec1

JayZ$weeks_on_chart <- vec_j
JayZ$weeks_number_one <-vec_2


B_and_J <- rbind(Beyonce, JayZ)


ggplot(B_and_J, aes(x=peak_position, y=weeks_on_chart, color = artist)) +
  geom_point() + # Show dots
  geom_label(label = rownames(B_and_J),
    nudge_x = 0.25, nudge_y = 0.25, 
    check_overlap = T
  ) +
    xlab('Peak Position of Album on UK Albums Chart') +
    ylab('Number of Weeks on Chart') + 
    ggtitle('How do Beyonce and Jay Z Matchup?')+
    theme_minimal()+
    theme(text=element_text(family="Times New Roman", size=11)) 

B_and_J <- rbind(Beyonce, JayZ) %>%
  mutate(albums2 =  str_trim(str_replace_all(albums,"[\r|\n]", "")))

# even with repel, titles of albums are too big to visualize all
# could label a subset?
# this is taking a random sample to label, although you might want to
# specify a specific subset
randsamp <- sample(x=B_and_J$albums2, size=10, replace=FALSE)
B_and_J_subset <- B_and_J %>%
  filter(albums2 %in% randsamp)

ggplot(data=B_and_J, aes(x=peak_position
                         , y=weeks_on_chart, color = artist)) +
  geom_point() + # Show dots
  geom_label_repel(data = B_and_J_subset
                   , aes(label = albums2,fill=artist)
                   , color="black", fontface="bold", size = 2) +
    xlab('Peak Position of Album on UK Albums Chart') +
    ylab('Number of Weeks on Chart') + 
    ggtitle('How do Beyonce and Jay Z Matchup?')+
    theme_minimal() +
    theme(text=element_text(family="Times New Roman", size=11)) +
    theme(plot.title = element_text(size = 15, face = "bold",
                                  margin = margin(10, 0, 10, 0))) +
    theme(legend.position = 'top')


```

Something we can see from this chart is that Beyoncé fares better in album performance between the two. While Beyoncé is a superstar, her success can be related to her pop genre music and previous work in Destiny's Child. Beyoncé is a singer in a much more mainstream and commercialized genre of music than Jay Z is. Even though Jay Z may not seem to be as successful in album sales as Beyoncé, he is a rapper and hip-hop has not been treated in the same regard as pop music has. 

```{r, echo=FALSE}
Beyonce %>%
  ggplot(aes(x = year, y = factor(peak_position, levels = rev(levels(factor(peak_position)))), fill = albums, color = albums, size = weeks_on_chart)) +
    geom_point( shape = 23) +
    geom_line() +
    ggtitle("Evolution of Beyonce's Chart Performance") +
    ylab('Peak Chart Position of Albums by Beyonce') +
    xlab('Date of Album Release') +
    theme_minimal() +
    theme(text=element_text(family="Times New Roman", size=11)) +
    theme(legend.position = 'right')
    
```

Beyonce's albums have always fared well. All 6 of her studio albums are chart toppers. One thing to note is that while this visualization might give one the sense that Beyonce hasn't made it big since 'I am Sasha Fierce', that is untrue. Beyoncé has only become more popular and more critically acclaimed. 'Lemonade is Beyonce's most critically acclaimed album. 'It is the introduction of her own streaming service, Tidal, which distorted the chart performance of her latest studio album 'Lemonade'. Because, Tidal is a much smaller and niche market

```{r, echo=FALSE}
JayZ %>%
  ggplot(aes(x=year, y = factor(peak_position, levels = rev(levels(factor(peak_position)))), fill = albums, color = albums, size = weeks_on_chart)) +
    geom_point( shape = 23) +
    geom_line() +
    ggtitle("Evolution of Jay Z's Chart Performance") +
    ylab('Peak Chart Position of Albums by Jay Z') +
    xlab('Date of Album Release') +
    theme_minimal() +
    theme(text=element_text(family="Times New Roman", size=11))
```

This visualization shows the evolution of Jay Z's chart performance. While the visualization shows that Jay Z has been on an upward trend, I'd like to note that this is not reflective of his success and fame. As a hip-hop artist, Jay Z would not fare well against pop music counterparts, especially because hip-hop has only become more mainstream in recent years. Another thing to note is that Jay Z almost exclusively released his music on his own streaming service, Tidal. He only released music on Spotify and Apple Music years later. This might affect how well his album performs on charts, despite his immense popularity.











# Sales Analysis













# Conclusion



How often a song contains a word or phrase does not provide a good indicator of what an album or body of work is about. We think that a more literary, tailored apprach to lyric analysis would provide more insight into the meaning behind the albums. 


